<UserControl x:Class="ISDP2025_Parfonov_Zerrou.Forms.StoreManagerUserControls.StoreManagerReceiveOrder"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
           xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
           xmlns:hc="https://handyorg.github.io/handycontrol"
           xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
           xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
           mc:Ignorable="d">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Text="Receiving/Accepting" 
                    Style="{StaticResource TextBlockLarge}" 
                    Margin="5"/>

            <!-- New ComboBox for Admin users -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Select Site:" 
                          Margin="10,0,5,0" 
                          VerticalAlignment="Center"
                          x:Name="lblSiteSelector" 
                          Visibility="Collapsed"/>
                <ComboBox x:Name="cmbSiteSelector" 
                          SelectedIndex="0"
                         Width="200" 
                         Margin="0,5" 
                         SelectionChanged="cmbSiteSelector_SelectionChanged"
                         Visibility="Collapsed"/>
            </StackPanel>

            <Button Grid.Column="3" 
                  x:Name="btnRefresh" 
                  Content="Refresh" 
                  Style="{StaticResource ButtonInfo}"
                  Click="btnRefresh_Click"
                  Width="80"
                  Margin="5"/>
        </Grid>

        <!-- Orders DataGrid -->
        <GroupBox x:Name="grpStatus" Grid.Row="1" Header="In Transit Orders" Margin="0,5">
            <DataGrid x:Name="dgvOrders" 
                   Height="150"
                   AutoGenerateColumns="False"
                   SelectionChanged="dgvOrders_SelectionChanged"
                   CanUserAddRows="False"
                   IsReadOnly="True"
                   SelectionMode="Single">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding TxnId}" Width="60"/>
                    <DataGridTextColumn Header="Store" Binding="{Binding StoreName}" Width="150"/>
                    <DataGridTextColumn Header="Type" Binding="{Binding TxnType}" Width="100"/>
                    <DataGridTextColumn Header="Ship Date" Binding="{Binding ShipDate, StringFormat={}{0:MM/dd/yyyy}}" Width="100"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding TxnStatus}" Width="100"/>
                    <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- Main Content Area -->
        <Grid Grid.Row="2" Margin="0,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Delivered Items -->
            <GroupBox x:Name="grpDeliveredItems" Grid.Column="0" Header="Items in Truck">
                <DockPanel>
                    <TextBox x:Name="txtSearch"
                           DockPanel.Dock="Top"
                           TextChanged="SearchBox_TextChanged"
                           Style="{StaticResource TextBoxExtend}"
                           hc:InfoElement.Placeholder="Search items by ID or name..."
                           Margin="0,5"/>

                    <DataGrid x:Name="dgvDeliveredItems" 
                            AutoGenerateColumns="False"
                            SelectionChanged="dgvDeliveredItems_SelectionChanged"
                            CanUserAddRows="False"
                            IsReadOnly="True"
                            SelectionMode="Single">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding ItemId}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                            <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="70"/>
                            <DataGridTextColumn Header="Case Size" Binding="{Binding CaseSize}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </GroupBox>

            <!-- Transfer Buttons -->
            <StackPanel Grid.Column="1" 
                      VerticalAlignment="Center" 
                      Margin="10">
                <Button x:Name="btnMoveToAccepted" 
                      Content="→" 
                      Style="{StaticResource ButtonPrimary}"
                      Click="btnMoveToAccepted_Click"
                      Width="40"
                      Margin="5"/>
                <Button x:Name="btnMoveBack" 
                      Content="←" 
                      Style="{StaticResource ButtonDanger}"
                      Click="btnMoveBack_Click"
                      Width="40"
                      Margin="5"/>
            </StackPanel>

            <!-- Accepted Items -->
            <GroupBox x:Name="grpAcceptedItems" Grid.Column="2" Header="Items Accepted into Store">
                <DockPanel>
                    <Button x:Name="btnComplete"
                          DockPanel.Dock="Bottom"
                          Content="Complete Receiving"
                          Style="{StaticResource ButtonSuccess}"
                          Click="btnComplete_Click"
                          Width="150"
                          Margin="5"
                          IsEnabled="False"/>

                    <DataGrid x:Name="dgvStoreItems" 
                            AutoGenerateColumns="False"
                            SelectionChanged="dgvStoreItems_SelectionChanged"
                            CanUserAddRows="False"
                            IsReadOnly="True"
                            SelectionMode="Single">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding ItemId}" Width="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                            <DataGridTextColumn Header="Accepted" Binding="{Binding Quantity}" Width="70"/>
                            <DataGridTextColumn Header="Current Stock" Binding="{Binding CurrentStock}" Width="90"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </GroupBox>
        </Grid>

        <!-- Signature Area - Initially Hidden -->
        <GroupBox x:Name="signatureSection" Grid.Row="3" Header="Store Manager Signature" Margin="0,10,0,0" Visibility="Collapsed">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Border BorderBrush="LightGray" BorderThickness="1" Margin="5">
                    <InkCanvas x:Name="inkSignature" Height="100" Background="WhiteSmoke"/>
                </Border>

                <StackPanel Grid.Column="1" Margin="5" VerticalAlignment="Center">
                    <Button x:Name="btnSign" 
                           Content="Confirm Signature" 
                           Style="{StaticResource ButtonPrimary}"
                           Click="btnSign_Click"
                           Width="120" 
                           Margin="0,5"/>

                    <Button x:Name="btnClearSignature" 
                           Content="Reset Signature" 
                           Style="{StaticResource ButtonWarning}"
                           Click="btnClearSignature_Click"
                           Width="120" 
                           Margin="0,5"
                           IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </GroupBox>
    </Grid>
</UserControl>
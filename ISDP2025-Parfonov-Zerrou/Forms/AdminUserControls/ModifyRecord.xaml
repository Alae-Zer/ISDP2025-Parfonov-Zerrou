<UserControl x:Class="ISDP2025_Parfonov_Zerrou.Forms.AdminUserControls.ModifyRecord"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:handycontrol="clr-namespace:HandyControl.Controls;assembly=HandyControl"
             xmlns:local="clr-namespace:ISDP2025_Parfonov_Zerrou.Forms.AdminUserControls"
             mc:Ignorable="d"
             Unloaded="UserControl_Unloaded">

    <UserControl.Resources>
        <Style x:Key="RoundedButton" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="5" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX"
                                             To="1.1" Duration="0:0:0.1"/>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY"
                                             To="1.1" Duration="0:0:0.1"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX"
                                             To="1" Duration="0:0:0.1"/>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY"
                                             To="1" Duration="0:0:0.1"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid Background="White" Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Transaction Record Modification" 
                 FontSize="24" 
                 FontWeight="Bold" 
                 Margin="0,0,0,10"
                 Grid.Row="0"/>

        <!-- Search Section -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <Label Content="Transaction ID:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBox x:Name="txtSearchTxnId" Width="100" Margin="0,0,10,0" Height="22"/>

            <Label Content="Status:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="cmbTxnStatus" Width="150" Margin="0,0,10,0" Height="22"
                    DisplayMemberPath="StatusName"
                    SelectedValuePath="StatusName"
                    SelectionChanged="ComboBox_SelectionChanged"/>

            <Label Content="Type:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="cmbTxnType" Width="150" Margin="0,0,10,0" Height="22"
                    DisplayMemberPath="TxnType1"
                    SelectedValuePath="TxnType1"
                    SelectionChanged="ComboBox_SelectionChanged"/>

            <Button x:Name="btnSearch" Content="Refresh" Width="95"  
                  Style="{StaticResource RoundedButton}"
                  Background="#2196F3"
                  Foreground="White"
                  Click="BtnSearch_Click"
                  Margin="5,0,0,0"/>
        </StackPanel>

        <!-- Transaction List Grid -->
        <GroupBox Grid.Row="2" Header="Transaction List" Margin="0,0,0,10">
            <DataGrid x:Name="dgvTransactions" 
                    Height="150"
                    AutoGenerateColumns="False"
                    IsReadOnly="True"
                    SelectionMode="Single"
                    SelectionChanged="DgvTransactions_SelectionChanged">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding TxnId}" Width="60"/>
                    <DataGridTextColumn Header="Type" Binding="{Binding TxnType}" Width="100"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding TxnStatus}" Width="100"/>
                    <DataGridTextColumn Header="From" Binding="{Binding SiteFrom}" Width="120"/>
                    <DataGridTextColumn Header="To" Binding="{Binding SiteTo}" Width="120"/>
                    <DataGridTextColumn Header="Ship Date" Binding="{Binding ShipDate, StringFormat=\{0:MM/dd/yyyy\}}" Width="100"/>
                    <DataGridTextColumn Header="Created Date" Binding="{Binding CreatedDate, StringFormat=\{0:MM/dd/yyyy\}}" Width="100"/>
                    <DataGridTextColumn Header="Employee" Binding="{Binding EmployeeName}" Width="120"/>
                    <DataGridTextColumn Header="Emergency" Binding="{Binding EmergencyDelivery}" Width="80"/>
                    <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="*"/>
                </DataGrid.Columns>
                <DataGrid.Style>
                    <Style TargetType="DataGrid">
                        <Style.Triggers>
                            <Trigger Property="HasItems" Value="False">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <TextBlock Text="Use search filters to find transactions" 
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontStyle="Italic"
                                                   Foreground="Gray"/>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Style>
            </DataGrid>
        </GroupBox>

        <!-- Transaction Details Section -->
        <GroupBox Grid.Row="3" Header="Transaction Details">
            <Grid x:Name="gridTransactionDetails" IsEnabled="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Row 0 -->
                <Label Content="Transaction ID:" Grid.Row="0" Grid.Column="0" Margin="5" FontWeight="Bold"/>
                <TextBlock x:Name="txtTxnId" Grid.Row="0" Grid.Column="1" Margin="5" VerticalAlignment="Center"/>

                <Label Content="Employee:" Grid.Row="0" Grid.Column="2" Margin="5"/>
                <TextBlock x:Name="txtEmployeeName" Grid.Row="0" Grid.Column="3" Margin="5" VerticalAlignment="Center"/>

                <!-- Row 1 -->
                <Label Content="Transaction Type:" Grid.Row="1" Grid.Column="0" Margin="5"/>
                <ComboBox x:Name="cmbEditTxnType" Grid.Row="1" Grid.Column="1" Margin="5"
                        DisplayMemberPath="TxnType1"
                        SelectedValuePath="TxnType1"
                        SelectionChanged="DetailsComboBox_SelectionChanged"/>

                <Label Content="Transaction Status:" Grid.Row="1" Grid.Column="2" Margin="5"/>
                <ComboBox x:Name="cmbEditTxnStatus" Grid.Row="1" Grid.Column="3" Margin="5"
                         DisplayMemberPath="StatusName"
                         SelectedValuePath="StatusName"
                         SelectionChanged="DetailsComboBox_SelectionChanged"/>

                <!-- Row 2 -->
                <Label Content="From Site:" Grid.Row="2" Grid.Column="0" Margin="5"/>
                <TextBlock x:Name="txtSiteFrom" Grid.Row="2" Grid.Column="1" Margin="5" VerticalAlignment="Center"/>

                <Label Content="To Site:" Grid.Row="2" Grid.Column="2" Margin="5"/>
                <ComboBox x:Name="cmbEditSiteTo" Grid.Row="2" Grid.Column="3" Margin="5"
                        DisplayMemberPath="SiteName"
                        SelectedValuePath="SiteId"
                        SelectionChanged="DetailsComboBox_SelectionChanged"/>

                <!-- Row 3 -->
                <Label Content="Ship Date:" Grid.Row="3" Grid.Column="0" Margin="5"/>
                <DatePicker x:Name="dpShipDate" Grid.Row="3" Grid.Column="1" Margin="5" SelectedDateChanged="DatePicker_SelectedDateChanged"/>

                <Label Content="Barcode:" Grid.Row="3" Grid.Column="2" Margin="5"/>
                <TextBox x:Name="txtBarCode" Grid.Row="3" Grid.Column="3" Margin="5"/>

                <!-- Row 4 -->
                <Label Content="Delivery ID:" Grid.Row="4" Grid.Column="0" Margin="5"/>
                <ComboBox x:Name="cmbDeliveryId" Grid.Row="4" Grid.Column="1" Margin="5"
                        DisplayMemberPath="DeliveryId"
                        SelectedValuePath="DeliveryId"
                        SelectionChanged="DetailsComboBox_SelectionChanged">
                    <ComboBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel/>
                        </ItemsPanelTemplate>
                    </ComboBox.ItemsPanel>
                </ComboBox>

                <Label Content="Emergency Delivery:" Grid.Row="4" Grid.Column="2" Margin="5"/>
                <CheckBox x:Name="chkEmergencyDelivery" Grid.Row="4" Grid.Column="3" Margin="5" VerticalAlignment="Center" Checked="CheckBox_CheckedChanged" Unchecked="CheckBox_CheckedChanged"/>

                <!-- Row 5 -->
                <Label Content="Notes:" Grid.Row="5" Grid.Column="0" Margin="5"/>
                <TextBox x:Name="txtNotes" Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="3" Margin="5"
                       TextWrapping="Wrap" AcceptsReturn="True" VerticalAlignment="Stretch"/>
            </Grid>
        </GroupBox>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button x:Name="btnClear" Content="Clear All" Width="100" Height="30" 
                  Style="{StaticResource RoundedButton}"
                  Background="#FFF62D2D"
                  Foreground="White"
                  Click="BtnClearSearch_Click"
                  Margin="0,0,10,0"/>

            <Button x:Name="btnCancel" Content="Cancel" Width="100" Height="30" 
                  Style="{StaticResource RoundedButton}"
                  Background="#FFF62D2D"
                  Foreground="White"
                  Click="BtnCancel_Click"
                  Margin="0,0,10,0"
                  Visibility="Collapsed"/>

            <Button x:Name="btnEdit" Content="Edit" Width="100" Height="30" 
                  Style="{StaticResource RoundedButton}"
                  Background="#FFD700"
                  Foreground="Black"
                  Click="BtnEdit_Click"
                  Margin="0,0,10,0"
                  IsEnabled="False"/>

            <Button x:Name="btnSave" Content="Save Changes" Width="120" Height="30" 
                  Style="{StaticResource RoundedButton}"
                  Background="#4CAF50"
                  Foreground="White"
                  Click="BtnSave_Click"
                  Visibility="Collapsed"/>
        </StackPanel>

        <!-- Record count display -->
        <TextBlock x:Name="lblRecordCount" 
                 Grid.Row="4" 
                 Margin="0,10,0,0"
                 HorizontalAlignment="Left"
                 FontStyle="Italic"
                 Foreground="Gray"/>
    </Grid>
</UserControl>